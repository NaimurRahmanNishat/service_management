// use moduler pattern (because this is big project)

backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ @types/
â”‚   â”‚   â””â”€â”€ api.d.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ cacheConfig.ts
â”‚   â”‚   â”œâ”€â”€ cloudinary.ts
â”‚   â”‚   â”œâ”€â”€ db.ts
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ redis.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ helper/
â”‚   â”‚   â”œâ”€â”€ baseImage.ts
â”‚   â”‚   â””â”€â”€ fileUploader.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts
â”‚   â”‚   â”œâ”€â”€ cacheAsync.ts
â”‚   â”‚   â””â”€â”€ validate.middleware.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ auth.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ user.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ service.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ service.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ service.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ service.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ service.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ service.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ booking/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ booking.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ booking.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ booking.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ booking.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ booking.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ booking.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ payment/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ payment.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ payment.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ payment.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ payment.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ payment.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ payment.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ review/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ review.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ review.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ review.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ review.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ review.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ review.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ report/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ report.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ report.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ report.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ report.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ report.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ report.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ support/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ support.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ support.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ support.repository.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ support.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ support.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ support.validation.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ finance/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ commission.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ withdrawal.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ paymentHistory.model.ts
â”‚   â”‚   â”‚   â””â”€â”€ finance.service.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ notification/
â”‚   â”‚   â”‚   â”œâ”€â”€ notification.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ notification.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ notification.route.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”‚   â”œâ”€â”€ requirement.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auditLog.model.ts
â”‚   â”‚   â”‚   â””â”€â”€ appConfig.model.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ vendor/
â”‚   â”‚       â”œâ”€â”€ requirement.txt
â”‚   â”‚       â”œâ”€â”€ vendorProfile.model.ts
â”‚   â”‚       â”œâ”€â”€ vendor.controller.ts
â”‚   â”‚       â”œâ”€â”€ vendor.route.ts
â”‚   â”‚       â””â”€â”€ vendor.service.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ cache.ts
â”‚   â”‚   â”œâ”€â”€ constants.ts
â”‚   â”‚   â”œâ”€â”€ cookie.ts
â”‚   â”‚   â”œâ”€â”€ email.ts
â”‚   â”‚   â”œâ”€â”€ errorHandler.ts
â”‚   â”‚   â”œâ”€â”€ token.ts
â”‚   â”‚   â””â”€â”€ response.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ app.ts
â”‚   â””â”€â”€ server.ts
â””â”€â”€ package.json






Client (FormData)
     â†“
Multer (Memory)
     â†“
Sharp (Resize + Compress)
     â†“
Cloudinary (Upload)
     â†“
MongoDB (Save URLs)




        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Client     â”‚
        â”‚  (Browser)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTPS
               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    NGINX     â”‚
        â”‚ LoadBalancer â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼      â–¼             â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Node #1 â”‚ â”‚ Node #2 â”‚ â”‚ Node #3 â”‚
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚           â”‚           â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
             â–¼           â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚    Redis     â”‚  â”‚  Database   â”‚
      â”‚              â”‚  â”‚ Mongo/Postg â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜







â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PAYMENT INITIATION                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                               â”‚
              â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Stripe Payment  â”‚          â”‚  IoT Payment     â”‚
    â”‚  (Online)        â”‚          â”‚  (Scanner/QR)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Create Payment   â”‚          â”‚ Scan QR Code     â”‚
    â”‚ Intent           â”‚          â”‚ Verify Device    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Process Payment  â”‚          â”‚ Process Payment  â”‚
    â”‚ via Stripe       â”‚          â”‚ via IoT API      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Payment Successful?          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                   â”‚
                   Yes                  No
                    â”‚                   â”‚
                    â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Create Transaction   â”‚  â”‚ Return Error     â”‚
    â”‚ Record               â”‚  â”‚ Rollback         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Calculate Commission Distribution   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Update Wallets (Vendor, Businessman)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Send Notifications                  â”‚
    â”‚  - Email                             â”‚
    â”‚  - SMS                               â”‚
    â”‚  - Push Notification                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Return Success Response             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜




## 6ï¸âƒ£ REST API Design

### API Endpoints Structure
```
BASE_URL: https://localhost:8000/api/v1
```

### Authentication Endpoints
```
POST   /auth/register          - Register new user
POST   /auth/login             - Login user
POST   /auth/refresh           - Refresh access token
POST   /auth/logout            - Logout user
POST   /auth/forgot-password   - Request password reset
POST   /auth/reset-password    - Reset password
GET    /auth/verify-email/:token - Verify email
```

### User Management Endpoints
```
GET    /users                  - Get all users (Admin only)
GET    /users/:id              - Get user by ID
PUT    /users/:id              - Update user
DELETE /users/:id              - Delete user (Super Admin)
PATCH  /users/:id/suspend      - Suspend user (Admin)
GET    /users/me               - Get current user profile
PUT    /users/me               - Update current user profile
```

### Product Management Endpoints
```
POST   /products               - Create product (Admin)
GET    /products               - Get all products
GET    /products/:id           - Get product by ID
PUT    /products/:id           - Update product (Admin)
DELETE /products/:id           - Delete product (Admin)
GET    /products/search        - Search products
GET    /products/category/:category - Get by category
```

### Rental Management Endpoints
```
POST   /rentals                - Create rental request
GET    /rentals                - Get all rentals
GET    /rentals/:id            - Get rental by ID
PATCH  /rentals/:id/approve    - Approve rental (Admin)
PATCH  /rentals/:id/reject     - Reject rental (Admin)
PATCH  /rentals/:id/terminate  - Terminate rental
GET    /rentals/vendor/:vendorId - Get vendor's rentals
GET    /rentals/product/:productId - Get product's rental history
```

### Payment Endpoints
```
POST   /payments/stripe/intent        - Create Stripe payment intent
POST   /payments/stripe/confirm       - Confirm Stripe payment
POST   /payments/iot/generate-qr      - Generate QR for IoT payment
POST   /payments/iot/process          - Process IoT payment
GET    /payments                      - Get all payments
GET    /payments/:id                  - Get payment by ID
POST   /payments/:id/refund           - Refund payment (Admin)
GET    /payments/user/:userId         - Get user's payment history
```

### Commission Endpoints
```
GET    /commissions                   - Get all commissions (Admin)
GET    /commissions/:id               - Get commission by ID
GET    /commissions/vendor/:vendorId  - Get vendor commissions
GET    /commissions/admin/:adminId    - Get admin commissions
POST   /commissions/withdraw          - Request commission withdrawal
GET    /commissions/reports           - Generate commission reports
IoT Device Endpoints
POST   /iot/devices                   - Add new IoT device (Admin)
GET    /iot/devices                   - Get all devices
GET    /iot/devices/:id               - Get device by ID
PUT    /iot/devices/:id               - Update device
DELETE /iot/devices/:id               - Delete device
PATCH  /iot















# ğŸ“š Booking, Payment & Location Availability - Complete Documentation

## ğŸ¯ Model Usage Overview

### 1ï¸âƒ£ **Booking Model** - à¦¬à§à¦•à¦¿à¦‚ à¦®à§à¦¯à¦¾à¦¨à§‡à¦œà¦®à§‡à¦¨à§à¦Ÿà§‡à¦° à¦œà¦¨à§à¦¯

**à¦•à¦–à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‡à¦¨:**
- User à¦¯à¦–à¦¨ à¦•à§‹à¦¨ service book à¦•à¦°à¦¬à§‡
- Vendor à¦¤à¦¾à¦° bookings à¦¦à§‡à¦–à¦¬à§‡
- Admin à¦¸à¦¬ bookings monitor à¦•à¦°à¦¬à§‡
- Booking status update à¦•à¦°à¦¬à§‡ (pending â†’ confirmed â†’ active â†’ completed)
- Booking cancel à¦•à¦°à¦¬à§‡

**Main Features:**
- Service booking creation
- Booking status tracking
- Payment linking
- Duration & quantity management
- Cancellation handling

---

### 2ï¸âƒ£ **Payment Model** - à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦ªà§à¦°à¦¸à§‡à¦¸à¦¿à¦‚ à¦à¦° à¦œà¦¨à§à¦¯

**à¦•à¦–à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‡à¦¨:**
- User payment à¦•à¦°à¦¬à§‡ (Stripe/Bkash/IoT Scanner)
- Payment status track à¦•à¦°à¦¬à§‡
- Refund process à¦•à¦°à¦¬à§‡
- Transaction history à¦¦à§‡à¦–à¦¬à§‡
- Payment verification à¦•à¦°à¦¬à§‡

**Main Features:**
- Multiple payment methods (Stripe, Bkash, IoT Scanner)
- Payment status tracking
- Transaction management
- Refund handling
- Payment metadata storage

---

### 3ï¸âƒ£ **Location Availability Model** - à¦²à§‹à¦•à§‡à¦¶à¦¨ à¦­à¦¿à¦¤à§à¦¤à¦¿à¦• à¦¸à§à¦Ÿà¦• à¦®à§à¦¯à¦¾à¦¨à§‡à¦œà¦®à§‡à¦¨à§à¦Ÿ

**à¦•à¦–à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‡à¦¨:**
- à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ location à¦ service availability track à¦•à¦°à¦¬à§‡
- Location wise stock management à¦•à¦°à¦¬à§‡
- User à¦¨à¦¿à¦•à¦Ÿà¦¬à¦°à§à¦¤à§€ location à¦ available service à¦–à§à¦à¦œà¦¬à§‡
- Multi-location inventory management à¦•à¦°à¦¬à§‡

**Main Features:**
- Location-wise quantity tracking
- Real-time availability status
- Multi-location support
- Automatic status update

---

## ğŸ“‹ Complete File Structure

```
src/modules/
â”œâ”€â”€ booking/
â”‚   â”œâ”€â”€ booking.model.ts
â”‚   â”œâ”€â”€ booking.interface.ts
â”‚   â”œâ”€â”€ booking.service.ts
â”‚   â”œâ”€â”€ booking.controller.ts
â”‚   â”œâ”€â”€ booking.routes.ts
â”‚   â””â”€â”€ booking.validation.ts
â”‚
â”œâ”€â”€ payment/
â”‚   â”œâ”€â”€ payment.model.ts
â”‚   â”œâ”€â”€ payment.interface.ts
â”‚   â”œâ”€â”€ payment.service.ts
â”‚   â”œâ”€â”€ payment.controller.ts
â”‚   â”œâ”€â”€ payment.routes.ts
â”‚   â””â”€â”€ payment.validation.ts
â”‚
â””â”€â”€ locationAvailability/
    â”œâ”€â”€ locationAvailability.model.ts
    â”œâ”€â”€ locationAvailability.interface.ts
    â”œâ”€â”€ locationAvailability.service.ts
    â”œâ”€â”€ locationAvailability.controller.ts
    â”œâ”€â”€ locationAvailability.routes.ts
    â””â”€â”€ locationAvailability.validation.ts
```

---

## ğŸ”„ Workflow Example

### **Complete Booking Flow:**

```
1. User selects service â†’ ServiceDetails page
2. User clicks "Book Now" â†’ Payment page
3. User selects payment method
4. CreateBooking API called
   â†“
5. Booking created (status: pending)
   â†“
6. Service quantity decreased
   â†“
7. CreatePayment API called
   â†“
8. Payment processed (Stripe/Bkash/IoT)
   â†“
9. Payment status updated (completed)
   â†“
10. Booking status updated (confirmed)
    â†“
11. User receives confirmation
```

---

## ğŸ“Š API Endpoints Overview

### **Booking APIs:**
```
POST   /api/bookings                    - Create booking
GET    /api/bookings                    - Get all bookings (admin)
GET    /api/bookings/my-bookings        - Get user's bookings
GET    /api/bookings/vendor-bookings    - Get vendor's bookings
GET    /api/bookings/:id                - Get single booking
PATCH  /api/bookings/:id/confirm        - Confirm booking
PATCH  /api/bookings/:id/cancel         - Cancel booking
PATCH  /api/bookings/:id/complete       - Complete booking
PATCH  /api/bookings/:id/status         - Update status
```

### **Payment APIs:**
```
POST   /api/payments                    - Create payment
POST   /api/payments/process            - Process payment
GET    /api/payments/my-payments        - Get user payments
GET    /api/payments/:id                - Get single payment
POST   /api/payments/:id/refund         - Refund payment
POST   /api/payments/verify             - Verify payment
```

### **Location Availability APIs:**
```
POST   /api/locations                   - Create location availability
GET    /api/locations                   - Get all locations
GET    /api/locations/service/:id       - Get by service
GET    /api/locations/city/:city        - Get by city
GET    /api/locations/:id               - Get single location
PATCH  /api/locations/:id               - Update location
DELETE /api/locations/:id               - Delete location
```

---

## ğŸ¨ Frontend Integration Example

### **Creating a Booking:**
```typescript
const handleBooking = async () => {
  // 1. Create booking
  const bookingResponse = await createBooking({
    serviceId: service._id,
    bookingType: "day",
    duration: { value: 3, unit: "day" },
    quantity: 2,
    startDate: "2024-01-20",
    endDate: "2024-01-23"
  });

  // 2. Process payment
  if (bookingResponse.success) {
    const paymentResponse = await processPayment({
      bookingId: bookingResponse.data._id,
      amount: bookingResponse.data.pricing.totalPrice,
      paymentMethod: "stripe"
    });

    // 3. Navigate to success page
    if (paymentResponse.success) {
      navigate(`/booking-success/${bookingResponse.data._id}`);
    }
  }
};
```

---

## ğŸ’¡ Key Features Explained

### **1. Automatic Status Management:**
- Booking status auto-updates based on payment
- Location availability auto-updates based on quantity
- Service status auto-updates based on bookings

### **2. Real-time Quantity Tracking:**
- Service quantity decreases on booking
- Service quantity increases on cancellation
- Location-wise tracking available

### **3. Payment Integration:**
- Multiple payment gateways supported
- Secure transaction handling
- Automatic refund processing

### **4. Multi-location Support:**
- Track service availability across locations
- Location-wise inventory management
- Nearest location search

---

## âš ï¸ Important Notes

1. **Payment Security:**
   - Never store full card details
   - Use payment gateway tokens
   - Encrypt sensitive data

2. **Booking Validation:**
   - Check service availability before booking
   - Validate dates (endDate > startDate)
   - Check quantity availability

3. **Cancellation Policy:**
   - Implement refund calculation
   - Update service quantity on cancel
   - Track cancellation reasons

4. **Error Handling:**
   - Handle payment failures gracefully
   - Rollback booking on payment failure
   - Proper error messages to users

---

## ğŸš€ Next Steps

After implementing these modules, you'll have:
- âœ… Complete booking system
- âœ… Multiple payment methods
- âœ… Location-based inventory
- âœ… Real-time availability tracking
- âœ… Admin dashboard ready APIs
- âœ… User booking management
- âœ… Vendor booking tracking

à¦à¦–à¦¨ à¦†à¦®à¦¿ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦¸à¦¬ files à¦¦à¦¿à¦šà§à¦›à¦¿...